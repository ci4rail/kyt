# ===================================================
# mounts
# ===================================================
mount=mount-kyt-src:
  bind: "kyt/"
  path: "/home/user/src"
  read-only: true

mount=mount-kyt-bin:
  bind: "bin/"
  path: "/home/user/bin"
  read-only: false

# ===================================================
# jobs
# ===================================================
job=build-kyt-cli:
  use: image-kyt-cli-builder
  command: |
    cd src; \
    make clean; \
    make;
  mounts:
    - mount-kyt-src
    - mount-kyt-bin
  sources:
    - kyt
  artifact:
    - bin
  env:
    - USERID={user.uid}
    - GROUPID={user.gid}
  annotations:
    description: "-> build kyt-cli"
    tags:
      - build

job=test:
  use: image-kyt-cli-builder
  command: bash
  interactive: true
  mounts:
    - mount-kyt-src
    - mount-kyt-bin
  env:
    - USERID={user.uid}
    - GROUPID={user.gid}
  annotations:
    description: "-> run interactive bash"
    tags:
      - build
